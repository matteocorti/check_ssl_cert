<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="UTF-8">
    <title>check_ssl_cert by matteocorti</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="stylesheets/normalize.css" media="screen">
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/github-light.css" media="screen">

    <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-72366500-1', 'auto');
  ga('send', 'pageview');

    </script>
    
  </head>
  <body>
    <section class="page-header">
      <h1 class="project-name">check_ssl_cert</h1>
      <h2 class="project-tagline">check_ssl_cert is a Nagios plugin to check the CA and validity of an X.509 certificate</h2>
      <a href="https://github.com/matteocorti/check_ssl_cert" class="btn">View on GitHub</a>
      <a href="https://github.com/matteocorti/check_ssl_cert/releases/latest" class="btn">Latest release</a>
    </section>

    <section class="main-content">

      <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
      <!-- Nagios plugins -->
      <ins class="adsbygoogle"
	   style="display:block"
	   data-ad-client="ca-pub-2546965931379033"
	   data-ad-slot="7735089259"
	   data-ad-format="auto"></ins>
      <script>
	(adsbygoogle = window.adsbygoogle || []).push({});
      </script>
      
      <p>A <a href="https://www.nagios.org">Nagios</a> plugin to check an X.509 certificate:</p>

      <ul>
	<li>checks if the server is running and delivers a valid certificate</li>
	<li>checks if the CA matches a given pattern</li>
	<li>checks the validity</li>
      </ul>

      <p>
	If you find this plugin
        useful you can help with
        a small contribution:  <form action="https://www.paypal.com/cgi-bin/webscr" method="post">
          <input type="hidden" name="cmd" value="_s-xclick">
          <input type="hidden" name="hosted_button_id" value="E5JBFG2Q24GLE">
          <input type="image" src="https://www.paypal.com/en_US/CH/i/btn/btn_donateCC_LG.gif" name="submit" alt="PayPal - The safer, easier way to pay online!">
          <img alt="" border="0" src="https://www.paypal.com/en_US/i/scr/pixel.gif" width="1" height="1">
        </form>
      </p>     
      
      <h1>
	<a id="usage" class="anchor" href="#usage" aria-hidden="true"><span class="octicon octicon-link"></span></a>Usage</h1>

      <pre>

Usage: check_ssl_cert -H host [OPTIONS]

Arguments:
   -H,--host host             server

Options:
   -A,--noauth                ignore authority warnings (expiration only)
      --altnames              matches the pattern specified in -n with alternate
                              names too
   -C,--clientcert path       use client certificate to authenticate
      --clientpass phrase     set passphrase for client certificate.
   -c,--critical days         minimum number of days a certificate has to be valid
                              to issue a critical status
      --curl-bin path         path of the curl binary to be used
   -d,--debug                 produces debugging output
   -e,--email address         pattern to match the email address contained in the
                              certificate
       --ecdsa                cipher selection: force ECDSA authentication
   -f,--file file             local file path (works with -H localhost only)
                              with -f you can not only pass a x509 certificate file
                              but also a certificate revocation list (CRL) to check
                              the validity period
      --file-bin path         path of the file binary to be used
      --fingerprint SHA1      pattern to match the SHA1-Fingerprint
      --force-perl-date       force the usage of Perl for date computations
      --format FORMAT         custom output format (e.g. "%SHORTNAME% OK %CN% from '%CA_ISSUER_MATCHED%'")
   -h,--help,-?               this help message
      --ignore-exp            ignore expiration date
      --ignore-sig-alg        do not check if the certificate was signed with SHA1
                              or MD5
      --ignore-ocsp           do not check revocation with OCSP
   -i,--issuer issuer         pattern to match the issuer of the certificate
      --issuer-cert-cache dir directory where to store issuer certificates cache
   -L,--check-ssl-labs grade  SSL Labs assestment
                              (please check https://www.ssllabs.com/about/terms.html)
      --ignore-ssl-labs-cache Forces a new check by SSL Labs (see -L)
      --long-output list      append the specified comma separated (no spaces) list
                              of attributes to the plugin output on additional lines
                              Valid attributes are:
                                enddate, startdate, subject, issuer, modulus,
                                serial, hash, email, ocsp_uri and fingerprint.
                              'all' will include all the available attributes.
   -n,--cn name               pattern to match the CN of the certificate (can be
                              specified multiple times)
      --no_ssl2               disable SSL version 2
      --no_ssl3               disable SSL version 3
      --no_tls1               disable TLS version 1
      --no_tls1_1             disable TLS version 1.1
      --no_tls1_2             disable TLS version 1.2
   -N,--host-cn               match CN with the host name
   -o,--org org               pattern to match the organization of the certificate
      --openssl path          path of the openssl binary to be used
   -p,--port port             TCP port
   -P,--protocol protocol     use the specific protocol
                              {http|smtp|pop3|imap|ftp|xmpp|irc|ldap}
                              http:                    default
                              smtp,pop3,imap,ftp,ldap: switch to TLS
   -s,--selfsigned            allows self-signed certificates
      --serial serialnum      pattern to match the serial number
      --sni name              sets the TLS SNI (Server Name Indication) extension
                              in the ClientHello message to 'name'
      --ssl2                  forces SSL version 2
      --ssl3                  forces SSL version 3
      --require-san           require the presence of a Subject Alternative Name
                              extension
   -r,--rootcert path         root certificate or directory to be used for
                              certificate validation
       --rsa                  cipher selection: force RSA authentication
   -t,--timeout               seconds timeout after the specified time
                              (defaults to 15 seconds)
      --temp dir              directory where to store the temporary files
      --tls1                  force TLS version 1
      --tls1_1                force TLS version 1.1
      --tls1_2                force TLS version 1.2
      --tls1_3                force TLS version 1.3
   -v,--verbose               verbose output
   -V,--version               version
   -w,--warning days          minimum number of days a certificate has to be valid
                              to issue a warning status
      --xmpphost name         specifies the host for the 'to' attribute of the stream element

Deprecated options:
      --days days             minimum number of days a certificate has to be valid
                              (see --critical and --warning)
      --ocsp                  check revocation via OCSP
   -S,--ssl version           force SSL version (2,3)
                              (see: --ssl2 or --ssl3)

Report bugs to https://github.com/matteocorti/check_ssl_cert/issues
      </pre>


      <h1>
	<a id="expect" class="anchor" href="#expect" aria-hidden="true"><span class="octicon octicon-link"></span></a>Expect</h1>

      <p>check_ssl_cert requires 'expect' to enable timouts. If expect is not
	present on your system timeouts will be disabled.</p>

      <p>See: <a href="http://en.wikipedia.org/wiki/Expect">http://en.wikipedia.org/wiki/Expect</a></p>

      <h1>
	<a id="perl-and-dateparse" class="anchor" href="#perl-and-dateparse" aria-hidden="true"><span class="octicon octicon-link"></span></a>Perl and Date::Parse</h1>
      
      <p>If perl and Date::Parse are available the plugin will also compute for
	how many days the certificate will be valid and put the information in
	the performance data. If perl or Date::Parse are not available the
	information will not be available.</p>
      
      <h1>
	<a id="virtual-servers" class="anchor" href="#virtual-servers" aria-hidden="true"><span class="octicon octicon-link"></span></a>
	Virtual servers
      </h1>
      
      <p>check_ssl_client supports the servername TLS extension in ClientHello
	if the installed openssl version provides it. This is needed if you
	are checking a machine with virtual hosts.</p>

      <h1>
	<a id="virtual-servers" class="anchor" href="#ssl-labs" aria-hidden="true"><span class="octicon octicon-link"></span></a>
	SSL Labs
      </h1>

      <p>
	If <code>-L</code> or <code>--check-ssl-labs</code> are specified the plugin will check the
	cached status using the <a href="https://www.ssllabs.com/about/terms.html">SSL Labs Assessment API</a>.
      </p>

      <p>
	The plugin will ask for a cached result (maximum age 1 day) to avoid
	to many checks. The first time you issue the check you could therefore
	get an outdated result.
      </p>
      
      <h1>
	<a id="notes" class="anchor" href="#notes" aria-hidden="true"><span class="octicon octicon-link"></span></a>Notes</h1>

<p>the root certificate corresponding to the checked certificate must be
available to openssl or specified with the '-r cabundle' or
'--rootcert cabundle' option, where cabundle is either a file for -CAfile
or a directory for -CApath.</p>

<p>On Mac OS X the root certificates bundle is stored in the Keychain and
openssl will complain with:</p>

<p>verification error: unable to get local issuer certificate</p>

<p>The bundle can be extracted with:</p>

<pre>
$ sudo security find-certificate -a \
    -p /System/Library/Keychains/SystemRootCertificates.keychain &gt; cabundle.crt
</pre>


      <footer class="site-footer">
        <span class="site-footer-owner"><a href="https://github.com/matteocorti/check_ssl_cert">Check ssl cert</a> is maintained by <a href="https://github.com/matteocorti">matteocorti</a>.</span>

        <span class="site-footer-credits">This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the <a href="https://github.com/jasonlong/cayman-theme">Cayman theme</a> by <a href="https://twitter.com/jasonlong">Jason Long</a>.</span>
      </footer>

    </section>

  
  </body>
</html>
